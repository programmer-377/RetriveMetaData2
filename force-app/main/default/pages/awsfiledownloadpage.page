<apex:page applyHtmlTag="false" showHeader="false" sidebar="false" standardStylesheets="false" docType="html-5.0">
    <html lang="en">
        <head>
            <meta charset="UTF-8"/>
            <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
            <title>Download AWS S3 Folder</title>
            <script src="https://cdn.jsdelivr.net/npm/aws-sdk@2.1202.0/dist/aws-sdk.min.js"></script>
        </head>
        <body>
            <h1>Download AWS S3 Folder</h1>

            <script>
                const awsAccessKey = 'AKIAYS2NUYP5LDAF3ODR';
                const awsSecretKey = '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';
                const bucketName = 'muthu-dev';
                const folderPath = 'testfolder';

                AWS.config.update({
                    accessKeyId: awsAccessKey,
                    secretAccessKey: awsSecretKey,
                    region: 'ap-south-1',
                });

                const s3 = new AWS.S3();

                s3.listObjectsV2({
                    Bucket: bucketName,
                    Prefix: folderPath,
                }, (err, data) => {
                    if (err) {
                        console.error(err);
                        return;
                    }

                    data.Contents.forEach(fileObject => {
                        const fileKey = fileObject.Key;
                        const fileUrl = `https://${bucketName}.s3.amazonaws.com/${fileKey}`;

                        const link = document.createElement('a');
                        link.href = fileUrl;
                        // link.download = fileKey.substring(fileKey.lastIndexOf('/') + 1);
                        // link.click();
                    });

                    console.log('Download complete.');
                });
            </script>
        </body>
    </html>
</apex:page>